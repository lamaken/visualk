<!DOCTYPE HTML>
<html lang="en-US">
    <head>
        <meta charset="UTF-8">
        <title>tubsJs</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        
        <script type="text/javascript" src = "njs/simpleGame.js"></script>
        <script type="text/javascript" src="njs/debug.js"></script>
        <script type="text/javascript" src="njs/tubsworld.js"></script>
        <script type="text/javascript" src="njs/animation.js"></script>
        <script type="text/javascript" src="njs/circuitdyn.js"></script>
        <script type="text/javascript" src="njs/index.js"></script>
        <script type="text/javascript" src="njs/Manifest.js"></script>

        <script type="text/javascript" src="njs/draw.js"></script>
        <link rel="stylesheet" type="text/css" href="css/hello.css">


        <script type="text/javascript">
            var timer;
            var output;
            var game;
            var stop = false;
            var dead_img;
            dead_img = new Image();
            dead_img.src = 'img/dead.png';

            var home_img;
            home_img = new Image();
            home_img.src = 'img/home.png';


            function is_touch_device() {
                return (('ontouchstart' in window)
                        || (navigator.MaxTouchPoints > 0)
                        || (navigator.msMaxTouchPoints > 0));
            }

            function resizecanvas() {
                var el = document.getElementById("myCanvas");
                if (!is_touch_device()) {
                    el.addEventListener("click", swapp, false);
                } else
                    el.addEventListener("touchstart", swapp, false);



                var w = window.innerWidth - 100;
                var h = window.innerHeight - 100;
                el.width = w;
                el.height = h;

            }

            function inicialitza() {
                var el = document.getElementById("myCanvas");
                if (!is_touch_device()) {
                    el.addEventListener("click", swapp, false);
                } else
                    el.addEventListener("touchstart", swapp, false);


                resizecanvas();
                game = new Scene();
                output = document.getElementById("output");
                timer = new Timer();
                timer.reset();
                game.start();

            }


            function update() {
                game.hide();
                currentTime = timer.getElapsedTime();
                // output.innerHTML = currentTime;
                //debug.output("time:" + currentTime);
                if (!stop)
                    animate2();

            } // end update

            function reset() {
                timer.reset();
                stop = !stop;
            } // end reset
        </script>
    </head>
    <body onresize="resizecanvas();" onload = "inicialitza();start();">

        <div id="img">
            <canvas id="myCanvas"> 
                <!-- TODO:Pensar en fer amb els tamanys -->
                NO CANVAS!!
            </canvas>
        </div>





        <div id="debug" style="visibility: hidden">
            error
        </div>
        <script>
            var debug = new Debug("player");
            var animation_debug = new Debug("aniamte.js");
            debug.output("get clone and go!");
            debug.output("git@github.com:lamaken/etubsworld.git");
        </script>
        <div id="circuits">
            <div id="output">empty</div>
            <!--button onclick = "reset()">
                reset timer
            </button-->
            <form name="fmain">
                <select name="circuits" onchange="start();">
                    <option value="default.xml">tubsworld</option>
                    <option value="circuit1.xml">circuit1</option>
                    <option value="circuit1b.xml">circuit1b</option>
                    <option value="circuit2.xml">circuit2</option>
                    <option value="circuit3.xml" selected="selected">circuit3</option>
                    <option value="circuit4.xml">circuit4</option>
                    <option value="circuit4b.xml">circuit4b</option>
                    <option value="circuit5.xml">circuit5</option>
                    <option value="circuit6.xml">circuit6</option>
                    <option value="circuit7.xml">circuit7</option>
                    <option value="circuit8.xml">circuit8</option>
                    <option value="circuit9.xml">circuit9</option>
                    <option value="circuit10.xml">circuit10</option>
                    <option value="circuit11.xml">circuit11</option>
                    <option value="circuit12.xml">circuit12</option>
                    <option value="ellipse.xml">elipse</option>

                </select>
            </form>
        </div>    
        <h1 id="fb-welcome"></h1>




        <script>
            // Place following code after FB.init call.

            function onLogin(response) {
                if (response.status == 'connected') {
                    FB.api('/me?fields=first_name', function (data) {
                        var welcomeBlock = document.getElementById('fb-welcome');
                        welcomeBlock.innerHTML = 'Hello, ' + data.first_name + '!';
                    });
                }
            }

            FB.getLoginStatus(function (response) {
                // Check login status on load, and if the user is
                // already logged in, go directly to the welcome message.
                if (response.status == 'connected') {
                    onLogin(response);
                } else {
                    // Otherwise, show Login dialog first.
                    FB.login(function (response) {
                        onLogin(response);
                    }, {scope: 'user_friends, email'});
                }
            });



            window.fbAsyncInit = function () {
                FB.init({
                    appId: '643785135776625',
                    xfbml: true,
                    version: 'v2.6'
                });

                // ADD ADDITIONAL FACEBOOK CODE HERE
            };

            (function (d, s, id) {
                var js, fjs = d.getElementsByTagName(s)[0];
                if (d.getElementById(id)) {
                    return;
                }
                js = d.createElement(s);
                js.id = id;
                js.src = "//connect.facebook.net/en_US/sdk.js";
                fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));
        </script>


    </body>
</html>